This algorithm does a peeling algorithm where we remove the possible neighbors one by one. 
It works ok, but is quite slow.